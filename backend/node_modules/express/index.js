function createRouter() {
  const routes = [];
  return {
    routes,
    use(path, handler) {
      if (typeof path === 'function') return; // ignore middleware
      if (handler && handler.routes) {
        const prefix = path === '/' ? '' : path;
        handler.routes.forEach(r => {
          const fullPath = prefix + r.path;
          routes.push({ method: r.method, path: fullPath, handler: r.handler });
        });
      }
    },
    get(path, handler) { routes.push({ method: 'get', path, handler }); },
    post(path, handler) { routes.push({ method: 'post', path, handler }); }
  };
}

function express() {
  return createRouter();
}

express.Router = createRouter;
express.json = () => (req, res, next) => { if (next) next(); };

module.exports = express;
